{
  "id": "69e7c320-b65d-41bb-be02-d63ecc0bcc9d",
  "queryName": "ECR Repository Without Policy",
  "severity": "LOW",
  "category": "Best Practices",
  "descriptionText": "Amazon Elastic Container Registry (ECR) repositories should have resource policies attached to them to enforce specific access controls. Without a repository policy, the repository may rely only on default AWS account permissions, which are not granular and may inadvertently allow unauthorized users or services to access, modify, or delete container images. This misconfiguration exposes the repository contents to security risks such as privilege escalation or data theft. To mitigate this, it is important to define an `aws_ecr_repository_policy` with the appropriate access permissions for each ECR repository.",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_security_rules/terraform/aws/ecr_repository_without_policy",
  "platform": "Terraform",
  "descriptionID": "cb9636f6",
  "cloudProvider": "aws",
  "cwe": "710",
  "oldDescriptionText": "ECR Repository should have Policies attached to it",
  "providerUrl": "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_repository_policy"
}